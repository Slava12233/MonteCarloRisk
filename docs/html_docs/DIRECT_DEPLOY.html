
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Direct Deployment Guide for Vertex AI Agent Engine - MonteCarloRisk_AI</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                mermaid.initialize({
                    startOnLoad: true,
                    theme: 'default',
                    securityLevel: 'loose',
                    flowchart: { useMaxWidth: false }
                });
            });
        </script>
    </head>
    <body>
        <div class="navbar">
            <h1>MonteCarloRisk_AI</h1>
            <p><a href="index.html" style="color: white;">‚Üê Back to Documentation Index</a></p>
        </div>
        
        <h1 id="direct-deployment-guide-for-vertex-ai-agent-engine">Direct Deployment Guide for Vertex AI Agent Engine</h1>
<h2 id="overview">Overview</h2>
<p>This guide explains how to use the <code>direct_deploy.py</code> script, which is the recommended method for deploying your Google ADK agent to Vertex AI Agent Engine. This streamlined script simplifies the deployment process by handling environment setup, agent creation, deployment, and configuration updates in a single step.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before using direct_deploy.py, ensure you have:</p>
<ol>
<li><strong>Google Cloud Project</strong>: An active Google Cloud project with the Vertex AI API enabled</li>
<li><strong>Storage Bucket</strong>: A Google Cloud Storage bucket for staging deployment files</li>
<li><strong>Python Environment</strong>: Python 3.9 or higher with required packages installed:
   <code>bash
   pip install 'google-cloud-aiplatform[adk,agent_engines]' python-dotenv</code></li>
<li><strong>Authentication</strong>: Proper authentication to Google Cloud:
   <code>bash
   gcloud auth application-default login</code></li>
</ol>
<h2 id="configuration">Configuration</h2>
<p>The script uses environment variables for configuration, which can be provided in a <code>.env</code> file or set directly in your environment:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Required variables</span>
<span class="n">GOOGLE_CLOUD_PROJECT</span><span class="o">=</span><span class="n">your</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="n">id</span>
<span class="n">STAGING_BUCKET</span><span class="o">=</span><span class="n">your</span><span class="o">-</span><span class="n">bucket</span><span class="o">-</span><span class="n">name</span>

<span class="c1"># Optional variables (defaults shown)</span>
<span class="n">GOOGLE_CLOUD_REGION</span><span class="o">=</span><span class="n">us</span><span class="o">-</span><span class="n">central1</span>
</code></pre></div>

<h3 id="environment-variables">Environment Variables</h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
<th>Required</th>
</tr>
</thead>
<tbody>
<tr>
<td>GOOGLE_CLOUD_PROJECT</td>
<td>Your Google Cloud Project ID</td>
<td>None</td>
<td>Yes</td>
</tr>
<tr>
<td>STAGING_BUCKET</td>
<td>GCS bucket for staging (with or without gs:// prefix)</td>
<td>None</td>
<td>Yes</td>
</tr>
<tr>
<td>GOOGLE_CLOUD_REGION</td>
<td>Google Cloud region for deployment</td>
<td>us-central1</td>
<td>No</td>
</tr>
</tbody>
</table>
<h2 id="usage">Usage</h2>
<p>To deploy your agent, simply run:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>direct_deploy.py
</code></pre></div>

<h2 id="what-the-script-does">What the Script Does</h2>
<p>The <code>direct_deploy.py</code> script performs the following steps:</p>
<ol>
<li><strong>Environment Setup</strong>:</li>
<li>Loads environment variables from <code>.env</code> file</li>
<li>Configures logging</li>
<li>
<p>Validates and formats configuration values</p>
</li>
<li>
<p><strong>Module Imports</strong>:</p>
</li>
<li>Imports necessary Vertex AI and ADK modules</li>
<li>
<p>Imports the BaseAgent class from your project</p>
</li>
<li>
<p><strong>Vertex AI Initialization</strong>:</p>
</li>
<li>
<p>Initializes Vertex AI with your project ID, region, and staging bucket</p>
</li>
<li>
<p><strong>Agent Creation</strong>:</p>
</li>
<li>Creates a BaseAgent instance with default or configured parameters</li>
<li>
<p>Prepares the agent for Agent Engine deployment using ADK</p>
</li>
<li>
<p><strong>Local Testing</strong>:</p>
</li>
<li>Tests the agent locally before deployment</li>
<li>Creates a test session and sends a test query</li>
<li>
<p>Validates that the agent responds correctly</p>
</li>
<li>
<p><strong>Deployment</strong>:</p>
</li>
<li>Deploys the agent to Vertex AI Agent Engine</li>
<li>Includes your project's <code>src</code> directory in the deployment package</li>
<li>
<p>Captures the Agent Engine ID for future reference</p>
</li>
<li>
<p><strong>Remote Testing</strong>:</p>
</li>
<li>Creates a test session on the deployed agent</li>
<li>
<p>Sends a test query to verify deployment success</p>
</li>
<li>
<p><strong>Configuration Update</strong>:</p>
</li>
<li>Updates the <code>chat.py</code> script with the new Agent Engine ID</li>
<li>Creates a backup of the original file</li>
<li>Updates Project ID and Location if necessary</li>
</ol>
<h2 id="example-output">Example Output</h2>
<p>A successful deployment will produce output similar to:</p>
<div class="codehilite"><pre><span></span><code><span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">33</span><span class="p">:</span><span class="mf">41</span><span class="p">,</span><span class="mf">030</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">Project</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="n">risk</span><span class="o">-</span><span class="n">manager</span><span class="o">-</span><span class="mf">457219</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">33</span><span class="p">:</span><span class="mf">41</span><span class="p">,</span><span class="mf">030</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">Region</span><span class="p">:</span><span class="w"> </span><span class="n">us</span><span class="o">-</span><span class="n">central1</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">33</span><span class="p">:</span><span class="mf">41</span><span class="p">,</span><span class="mf">030</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="n">Staging</span><span class="w"> </span><span class="n">Bucket</span><span class="p">:</span><span class="w"> </span><span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">risk7</span>
<span class="mf">...</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">37</span><span class="p">:</span><span class="mf">48</span><span class="p">,</span><span class="mf">023</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">deployed</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">Engine</span><span class="p">:</span><span class="w"> </span><span class="mf">1578942677951447040</span>
<span class="mf">...</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">37</span><span class="p">:</span><span class="mf">52</span><span class="p">,</span><span class="mf">590</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Direct</span><span class="w"> </span><span class="n">deployment</span><span class="w"> </span><span class="n">completed</span><span class="w"> </span><span class="n">successfully</span><span class="err">!</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">37</span><span class="p">:</span><span class="mf">52</span><span class="p">,</span><span class="mf">590</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Agent</span><span class="w"> </span><span class="n">Engine</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="mf">1578942677951447040</span>
<span class="mf">2025</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">21</span><span class="w"> </span><span class="mf">08</span><span class="p">:</span><span class="mf">37</span><span class="p">:</span><span class="mf">52</span><span class="p">,</span><span class="mf">590</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">direct_deploy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="nb">int</span><span class="n">eract</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">agent</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">&#39;</span><span class="n">python</span><span class="w"> </span><span class="n">chat</span><span class="mf">.</span><span class="n">py</span><span class="err">&#39;</span>
</code></pre></div>

<h2 id="using-the-deployed-agent">Using the Deployed Agent</h2>
<p>After successful deployment, you can interact with your agent using the <code>chat.py</code> script:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>chat.py
</code></pre></div>

<p>The <code>chat.py</code> script is automatically updated with your new Agent Engine ID, so you don't need to make any manual changes.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="authentication-errors">Authentication Errors</h4>
<p><strong>Symptom</strong>: Error messages about missing authentication or permissions.</p>
<p><strong>Solution</strong>:
1. Run <code>gcloud auth application-default login</code>
2. Verify your user account has the Vertex AI User role (roles/aiplatform.user)</p>
<h4 id="missing-dependencies">Missing Dependencies</h4>
<p><strong>Symptom</strong>: Module import errors.</p>
<p><strong>Solution</strong>:</p>
<div class="codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span><span class="s1">&#39;google-cloud-aiplatform[adk,agent_engines]&#39;</span><span class="w"> </span>python-dotenv
</code></pre></div>

<h4 id="deployment-timeout">Deployment Timeout</h4>
<p><strong>Symptom</strong>: The deployment appears to hang or takes extremely long.</p>
<p><strong>Solution</strong>: 
1. Check your network connection
2. Verify the Vertex AI API is enabled in your project
3. Check Cloud Logging for detailed error messages</p>
<h4 id="chatpy-not-found-or-not-updated">chat.py Not Found or Not Updated</h4>
<p><strong>Symptom</strong>: The script cannot find or update chat.py.</p>
<p><strong>Solution</strong>: 
1. Create a basic chat.py file in the project root if it doesn't exist
2. Ensure you have write permissions to the file</p>
<h2 id="comparison-with-other-deployment-methods">Comparison with Other Deployment Methods</h2>
<table>
<thead>
<tr>
<th>Feature</th>
<th>direct_deploy.py</th>
<th>deploy_agent_engine.py</th>
<th>redeploy.py</th>
</tr>
</thead>
<tbody>
<tr>
<td>Configuration Source</td>
<td>Environment variables</td>
<td>YAML configuration files</td>
<td>YAML and command line</td>
</tr>
<tr>
<td>Environment Support</td>
<td>Single environment</td>
<td>Multiple environments</td>
<td>Multiple environments</td>
</tr>
<tr>
<td>chat.py Update</td>
<td>Automatic</td>
<td>Manual</td>
<td>Automatic</td>
</tr>
<tr>
<td>Complexity</td>
<td>Low</td>
<td>Medium</td>
<td>Medium</td>
</tr>
<tr>
<td>Use Case</td>
<td>Quick deployments</td>
<td>Complex configuration</td>
<td>Redeployments with config</td>
</tr>
</tbody>
</table>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Use Version Control</strong>: Commit your deployment script to version control, but exclude .env files with sensitive information</li>
<li><strong>Create a Deployment User</strong>: Create a dedicated service account for deployments with minimal permissions</li>
<li><strong>Verify After Deployment</strong>: Always test your deployed agent with real queries before considering deployment complete</li>
<li><strong>Monitor Logs</strong>: Check Cloud Logging after deployment for any warnings or errors</li>
<li><strong>Regular Backups</strong>: Keep backups of your chat.py file (the script does this automatically)</li>
</ol>
<hr />
<p><em>Document Version: 1.0</em><br />
<em>Last Updated: April 21, 2025</em><br />
<em>Author: [Your Name], CTO</em> </p>
        
        <div class="footer">
            <p>Generated on 2025-04-21 09:00:32</p>
            <p><a href="index.html">Back to Documentation Index</a></p>
        </div>
    </body>
    </html>
    